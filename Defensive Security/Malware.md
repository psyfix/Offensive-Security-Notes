### Malware Analysis
#### Defense Evasion
##### Ordinal Calls
- Instead of calling the DLL function name directly it is possible to use the functions ordinal number.
- This obfuscates the name of the function completely. Most EDRs scanning for common windows DLL function names will miss it.
- Inside a binary first the DLL is loaded with **LoadLibrary**. Then the function is called with **GetProcAddress**.
- It is possible to walk the entire table of a DLL module first and then matching the hash of a function before using that to call it also.

How to defend?
- Its possible to reverse engineer the ordinal number and map it to the function name using a tool such as **dumpbin**.

Rule Detection Example
- This kind of detection is possible via Sysmon (7 OR 10) when enriched with stack traces.
- This kind of rule can also be implemented into an EDR.
```
Rule: Suspicious GetProcAddress Usage
If:
	ImageLoaded = "*\\kernel32.dll" OR "*\\ntdll.dll"
	AND
	CallTo = "GetProcAddress"
	AND
	LoadedFunctionName = null OR numeric (ordinal)
Then:
	Alert
```

Example
